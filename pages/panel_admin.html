<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Administración PAC Pesos</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <style>
    body{font-family:Inter,Segoe UI,Roboto,Arial;margin:1rem;background:#f6f8fa;color:#111}
    .card{background:#fff;border-radius:8px;padding:18px;max-width:960px;margin:1rem auto;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
    h1{font-size:1.2rem;margin:0 0 8px}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    input,select,button{padding:8px;border-radius:6px;border:1px solid #ddd;font-size:0.95rem}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{padding:8px;border-bottom:1px solid #eee;text-align:left;font-size:0.95rem}
    .muted{color:#666;font-size:0.9rem}
    .ok{color:green}.err{color:#b00020}
    .info{color:#00529b}
    .small{font-size:0.85rem;color:#666}
    .spinner{display:inline-block;width:14px;height:14px;border:2px solid #ccc;border-top-color:#333;border-radius:50%;animation:spin .8s linear infinite;vertical-align:middle;margin-right:6px}
    @keyframes spin{to{transform:rotate(360deg)}}
    .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-top:8px}
  </style>
</head>
<body>
  <div class="card">
    <h1>Panel de Administración - PAC Pesos</h1>
    <p class="muted">Operaciones para dirección: resumen por curso, entregas masivas y generación de tokens/QRs.</p>

    <div class="controls">
      <label>Admin Key: <input id="adminKey" type="password" placeholder="admin key"/></label>
      <button id="btnResumen" onclick="fetchResumen()">Resumen por curso</button>
      <button id="btnTokens" onclick="confirmGenerarTokens()">Generar tokens</button>
      <button id="btnQRs" onclick="confirmGenerarQRs()">Generar QRs (Drive)</button>
    </div>

    <div style="margin-top:12px">
      <h3>Entrega masiva</h3>
      <div class="row">
        <input id="curso" placeholder="Curso (ej: 5A)"/>
        <input id="cantidad" type="number" placeholder="Cantidad a entregar" min="1"/>
        <input id="motivo" placeholder="Motivo"/>
        <input id="registradoPor" placeholder="Registrado por"/>
        <button id="btnEntrega" onclick="confirmEntregaMasiva()">Ejecutar entrega masiva</button>
      </div>
      <div id="mensaje" style="margin-top:12px"></div>
    </div>

    <div id="resumen" style="margin-top:16px"></div>

    <p class="small" style="margin-top:12px">Nota: La URL del WebApp está embebida en el cliente. Para mayor seguridad, mueva las operaciones administrativas a un backend autenticado o proteja la WebApp adecuadamente.</p>
  </div>

<script>
const URL_WEBAPP = 'https://script.google.com/macros/s/AKfycby1lAe_qwvRPgXRiKhmH3ibkhhdML4IuGFCu4oPR649QJbqzB0Y_6QfRdpDqO9UJnw05g/exec'; // REEMPLAZA con la URL de tu WebApp desplegada

function showMsg(text, type='info'){
  const el = document.getElementById('mensaje');
  const cls = type === 'ok' ? 'ok' : (type === 'err' ? 'err' : 'info');
  el.innerHTML = '<div class="'+cls+'">'+escapeHtml(text)+'</div>';
}

function setBusy(btnIds = [], busy=true, text='Procesando...'){
  // disable/enable buttons and show small status
  btnIds.forEach(id => {
    const b = document.getElementById(id);
    if(!b) return;
    b.disabled = busy;
  });
  const el = document.getElementById('mensaje');
  if(busy){
    el.innerHTML = '<div class="info"><span class="spinner"></span>'+escapeHtml(text)+'</div>';
  } else {
    // leave previous message
  }
}

function escapeHtml(s){
  if(!s && s !== 0) return '';
  return String(s).replace(/[&<>\"'`]/g, s => {'&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;', '`': '&#x60;'}[s]);
}
function fetchResumen() { /* Your fetch logic here */ }
function confirmGenerarTokens() { /* Confirmation logic here */ }
function confirmGenerarQRs() { /* Confirmation logic here */ }
function confirmEntregaMasiva() { /* Mass delivery logic here */ }
</script>
</body>
</html>